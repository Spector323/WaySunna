<div class="profile-container" *ngIf="user && !error">
  <div class="profile-header">
    <h2>Профиль</h2>
  </div>

  <div class="profile-card">
    <div class="avatar-section">
      <ng-container *ngIf="user.avatar; else noAvatar">
        <ng-container *ngIf="isVideo(user.avatar); else imageAvatar">
          <video [src]="'http://localhost:5000/' + user.avatar" controls class="avatar"></video>
        </ng-container>
        <ng-template #imageAvatar>
          <img [src]="avatarUrl || 'http://localhost:5000/' + user.avatar" alt="Аватар" class="avatar" />
        </ng-template>
      </ng-container>
      <ng-template #noAvatar>
        <div class="avatar-placeholder">
          <svg width="80" height="80" viewBox="0 0 24 24" fill="#ccc">
            <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z"/>
          </svg>
        </div>
      </ng-template>
      <label for="avatar" class="avatar-edit">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="#fff">
          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
        </svg>
        <input
          type="file"
          id="avatar"
          accept="image/jpeg,image/png,video/mp4"
          (change)="onFileChange($event)"
          hidden
        />
      </label>
    </div>

    <div class="user-info">
      <p><strong>Имя:</strong> {{ user.name }}</p>
      <p><strong>Email:</strong> {{ user.email }}</p>
      <p><strong>Телефон:</strong> {{ user.phone || 'Не указан' }}</p>
      <p><strong>Дата регистрации:</strong> {{ user.registrationDate | date:'dd.MM.yyyy HH:mm' }}</p>
    </div>

    <div class="action-buttons">
      <button class="edit-btn" (click)="toggleEdit()">{{ isEditing ? 'Отмена' : 'Изменить' }}</button>
      <button class="logout-btn" (click)="logout()">Выйти</button>
    </div>
  </div>

  <div class="edit-form" *ngIf="isEditing">
    <h3>Редактировать профиль</h3>
    <form>
      <div class="form-group">
        <label for="name">Имя:</label>
        <input
          type="text"
          id="name"
          [(ngModel)]="name"
          placeholder="Введите имя"
          class="form-input"
          [ngModelOptions]="{standalone: true}"
        />
      </div>

      <div class="form-group">
        <label for="email">Email:</label>
        <input
          type="email"
          id="email"
          [(ngModel)]="email"
          placeholder="Введите email"
          class="form-input"
          [ngModelOptions]="{standalone: true}"
        />
      </div>

      <div class="form-group">
        <label for="phone">Телефон:</label>
        <input
          type="tel"
          id="phone"
          [(ngModel)]="phone"
          placeholder="Например, +79991234567"
          class="form-input"
          [ngModelOptions]="{standalone: true}"
        />
      </div>

      <p class="error-message">{{ error }}</p>
      <button
        (click)="updateProfile()"
        class="submit-button"
        [disabled]="isSubmitting"
      >
        {{ isSubmitting ? 'Сохранение...' : 'Сохранить' }}
      </button>
    </form>
  </div>
</div>
<div *ngIf="error" class="not-found">{{ error }}</div>